# Silicon workflow via PWTK

# Base SCF input
CONTROL {
    calculation  = 'scf'
    prefix       = 'silicon'
    outdir       = './tmp'
}
SYSTEM {
    ibrav     = 2
    celldm(1) = 10.26
    nat       = 2
    ntyp      = 1
    ecutwfc   = 30.0
    occupations = 'smearing'
    smearing    = 'mp'
    degauss     = 0.02
}
ELECTRONS {
    conv_thr   = 1.0d-8
    mixing_beta = 0.7
}
ATOMIC_SPECIES {
    Si 28.085 Si.pbe-n-rrkjus_psl.1.0.0.UPF
}
ATOMIC_POSITIONS crystal {
    Si 0.00 0.00 0.00
    Si 0.25 0.25 0.25
}
K_POINTS automatic {
    6 6 6   0 0 0
}

runPW pw.si.scf

# NSCF for DOS/PDOS
input_pushpop {
    CONTROL {
        calculation = 'nscf'
    }
    SYSTEM {
        occupations = 'fixed'
        nbnd        = 16
    }
    K_POINTS automatic {
        12 12 12  0 0 0
    }
    runPW pw.si.nscf
}

# Band structure (Gamma-X-W-K-Gamma-L path)
input_pushpop {
    CONTROL {
        calculation = 'bands'
    }
    K_POINTS crystal_b {
        6
        0.0000 0.0000 0.0000 40
        0.5000 0.0000 0.5000 40
        0.5000 0.2500 0.7500 40
        0.3750 0.3750 0.7500 40
        0.0000 0.0000 0.0000 40
        0.5000 0.5000 0.5000 40
    }
    runPW pw.si.bands
}

BANDS {
    prefix  = 'silicon'
    filband = 'silicon.bands.dat'
}
runBANDS bands.si

# Total DOS
DOS {
    prefix = 'silicon'
    Emin   = -15.0
    Emax   = 20.0
    DeltaE = 0.02
    fildos = 'silicon.dos'
}
runDOS dos.si

# Projected DOS
PROJWFC {
    prefix  = 'silicon'
    degauss = 0.02
    Emin    = -10.0
    Emax    = 15.0
    DeltaE  = 0.05
    filproj = 'silicon_pdos'
}
runPROJWFC projwfc.si
